{"ast":null,"code":"import React,{createContext,useState,useEffect,useCallback,useContext}from\"react\";import axios from\"axios\";import{jsx as _jsx}from\"react/jsx-runtime\";const API_URL=\"http://localhost:5001/api\";const AuthContext=/*#__PURE__*/createContext();export const AuthProvider=_ref=>{let{children}=_ref;const[user,setUser]=useState(null);const[loading,setLoading]=useState(true);// get ussers\nconst fetchUser=useCallback(async()=>{const token=localStorage.getItem(\"token\");if(!token){setLoading(false);return;}try{const response=await axios.get(`${API_URL}/auth/me`,{headers:{Authorization:`Bearer ${token}`},withCredentials:true});if(response.data){setUser(response.data);}else{logout();}}catch(error){var _error$response;console.error(\"ðŸš¨ Error fetching user:\",((_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.data)||error);logout();}finally{setLoading(false);}},[]);useEffect(()=>{fetchUser();},[fetchUser]);// login\nconst login=async(email,password)=>{try{const response=await axios.post(`${API_URL}/auth/login`,{email,password});const{token,user}=response.data;if(token){localStorage.setItem(\"token\",token);setUser(user);}else{throw new Error(\"Token missing in response!\");}}catch(error){var _error$response2,_error$response3;console.error(\"ðŸš¨ Login error:\",((_error$response2=error.response)===null||_error$response2===void 0?void 0:_error$response2.data)||error);return((_error$response3=error.response)===null||_error$response3===void 0?void 0:_error$response3.data)||{error:\"Failed to login\"};}};// signup \nconst signup=async(name,email,password,role)=>{try{const response=await axios.post(`${API_URL}/auth/signup`,{name,email,password,role});const{token,user}=response.data;if(token){localStorage.setItem(\"token\",token);setUser(user);}else{throw new Error(\"Token missing in response!\");}}catch(error){var _error$response4,_error$response5;console.error(\"ðŸš¨ Signup error:\",((_error$response4=error.response)===null||_error$response4===void 0?void 0:_error$response4.data)||error);return((_error$response5=error.response)===null||_error$response5===void 0?void 0:_error$response5.data)||{error:\"Failed to register\"};}};// logout\nconst logout=()=>{localStorage.removeItem(\"token\");setUser(null);alert(\"âœ… Successfully signed out!\");window.location.href=\"/login\";};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:{user,login,signup,logout,loading},children:children});};export const useAuth=()=>useContext(AuthContext);export default AuthContext;","map":{"version":3,"names":["React","createContext","useState","useEffect","useCallback","useContext","axios","jsx","_jsx","API_URL","AuthContext","AuthProvider","_ref","children","user","setUser","loading","setLoading","fetchUser","token","localStorage","getItem","response","get","headers","Authorization","withCredentials","data","logout","error","_error$response","console","login","email","password","post","setItem","Error","_error$response2","_error$response3","signup","name","role","_error$response4","_error$response5","removeItem","alert","window","location","href","Provider","value","useAuth"],"sources":["/Users/a79/Downloads/my-real-estate-project/frontend/src/context/AuthContext.js"],"sourcesContent":["import React, { createContext, useState, useEffect, useCallback, useContext } from \"react\";\nimport axios from \"axios\";\n\nconst API_URL = \"http://localhost:5001/api\";\n\nconst AuthContext = createContext();\n\nexport const AuthProvider = ({ children }) => {\n    const [user, setUser] = useState(null);\n    const [loading, setLoading] = useState(true);\n\n    // get ussers\n    const fetchUser = useCallback(async () => {\n        const token = localStorage.getItem(\"token\");\n        if (!token) {\n            setLoading(false);\n            return;\n        }\n\n        try {\n            const response = await axios.get(`${API_URL}/auth/me`, {\n                headers: { Authorization: `Bearer ${token}` },\n                withCredentials: true,\n            });\n\n            if (response.data) {\n                setUser(response.data);\n            } else {\n                logout();\n            }\n        } catch (error) {\n            console.error(\"ðŸš¨ Error fetching user:\", error.response?.data || error);\n            logout();\n        } finally {\n            setLoading(false);\n        }\n    }, []);\n\n    useEffect(() => {\n        fetchUser();\n    }, [fetchUser]);\n\n    // login\n    const login = async (email, password) => {\n        try {\n            const response = await axios.post(`${API_URL}/auth/login`, { email, password });\n\n            const { token, user } = response.data;\n            if (token) {\n                localStorage.setItem(\"token\", token);\n                setUser(user);\n            } else {\n                throw new Error(\"Token missing in response!\");\n            }\n        } catch (error) {\n            console.error(\"ðŸš¨ Login error:\", error.response?.data || error);\n            return error.response?.data || { error: \"Failed to login\" };\n        }\n    };\n\n    // signup \n    const signup = async (name, email, password, role) => {\n        try {\n            const response = await axios.post(`${API_URL}/auth/signup`, { name, email, password, role });\n\n            const { token, user } = response.data;\n            if (token) {\n                localStorage.setItem(\"token\", token);\n                setUser(user);\n            } else {\n                throw new Error(\"Token missing in response!\");\n            }\n        } catch (error) {\n            console.error(\"ðŸš¨ Signup error:\", error.response?.data || error);\n            return error.response?.data || { error: \"Failed to register\" };\n        }\n    };\n\n    // logout\n    const logout = () => {\n        localStorage.removeItem(\"token\");\n        setUser(null);\n        alert(\"âœ… Successfully signed out!\");\n        window.location.href = \"/login\";\n\n    };\n\n    return (\n        <AuthContext.Provider value={{ user, login, signup, logout, loading }}>\n            {children}\n        </AuthContext.Provider>\n    );\n};\n\nexport const useAuth = () => useContext(AuthContext);\n\nexport default AuthContext;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}